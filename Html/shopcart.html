<!--
Propósito: Página de carrito de compras. Muestra productos agregados, permite modificar cantidades, eliminar productos y ver el total. Incluye resumen de compra y diseño responsivo.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help - Fakestore</title>
    <link rel="stylesheet" href="/Css/style.css">
</head>
<body>
    <header class="navbar">
        <div class="logo">Fakestore</div>
        <nav>
            <a href="index.html" class="navbarOptions">Store</a>
            <a href="shopcart.html"class="navbarOptions">Shopping kart</a>
            <a href="contacts.html" class="navbarOptions">Contacts</a>
            <a href="config.html" class="navbarOptions">Configuration</a>
            <a href="support.html" class="navbarOptions" style="color:#d1bfa7;font-weight:700;">Help</a>
        </nav>
        <div class="cart">
            <span>Kart (0)</span>
        </div>
    </header>
    <main>
      <h2 style="text-align:center;margin:32px 0 16px;">Carrito de compras</h2>
      <section id="cartSection" style="max-width:900px;margin:0 auto;"></section>
    </main>
    <script>
// Guardar y aplicar configuraciones globales
function aplicarConfiguraciones() {
  // Modo oscuro
  if(localStorage.getItem('modoOscuro') === 'true') {
    document.body.classList.add('dark-mode');
  } else {
    document.body.classList.remove('dark-mode');
  }
  // Idioma
  const idioma = localStorage.getItem('idioma') || 'es';
  document.documentElement.lang = idioma;
  // Preferencia de visualización
  const vista = localStorage.getItem('vista') || 'grid';
  const grid = document.getElementById('grid');
  if(grid) {
    grid.className = vista;
  }
}
//aplicar configuraciones
aplicarConfiguraciones();
window.addEventListener('storage', aplicarConfiguraciones);

// Renderizar carrito
function renderizarCarrito() {
  const carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
  console.log('carrito en shopcart:', carrito);
  const cont = document.getElementById('cartSection');
  if(carrito.length === 0) {
    cont.innerHTML = '<div style="text-align:center;color:#888;font-size:1.2rem;">El carrito está vacío.</div>';
    document.getElementById('cartSummary')?.remove();
    return;
  }
  let total = 0;
  cont.innerHTML = `
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;">
      <button onclick="vaciarCarrito()" style="background:#e0e0e0;color:#333;padding:8px 18px;border-radius:8px;border:none;cursor:pointer;font-weight:600;">Vaciar carrito</button>
      <button onclick="mostrarResumenCompra()" style="background:#d1bfa7;color:#fff;padding:8px 18px;border-radius:8px;border:none;cursor:pointer;font-weight:600;">Resumen de compra</button>
    </div>
  `;
  cont.innerHTML += carrito.map((p, i) => {
    console.log('producto en render:', p);
    total += p.price * p.cantidad;
    return `
      <div class="card" style="display:flex;align-items:center;gap:24px;margin-bottom:18px;">
        <div style="flex:0 0 90px;">
          <img src="${p.image}" alt="${p.title}" style="width:90px;height:90px;object-fit:contain;border-radius:12px;background:#fff;border:1px solid #e0e0e0;" />
        </div>
        <div style="flex:1;">
          <div style="font-weight:600;font-size:1.1rem;">${p.title}</div>
          <div style="color:#888;font-size:0.95rem;">${p.category}</div>
        </div>
        <div style="font-weight:700;font-size:1.1rem;color:#d1bfa7;">$${p.price}</div>
        <div style="display:flex;align-items:center;gap:8px;">
          <button onclick="modificarCantidad(${i}, -1)" style="background:#e0e0e0;color:#333;padding:4px 10px;border-radius:6px;border:none;cursor:pointer;">-</button>
          <span style="font-weight:600;">${p.cantidad}</span>
          <button onclick="modificarCantidad(${i}, 1)" style="background:#e0e0e0;color:#333;padding:4px 10px;border-radius:6px;border:none;cursor:pointer;">+</button>
        </div>
        <button onclick="eliminarDelCarrito(${i})" style="background:#ffb0b6;color:#fff;font-weight:600;padding:8px 16px;border-radius:8px;border:none;cursor:pointer;">Eliminar</button>
      </div>
    `;
  }).join('') + `<div style="text-align:right;font-size:1.2rem;font-weight:700;margin-top:24px;">Total: $${total.toFixed(2)}</div>`;
  document.getElementById('cartSummary')?.remove();
}
// Vaciar carrito
function vaciarCarrito() {
  localStorage.removeItem('carrito');
  renderizarCarrito();
}

// Mostrar resumen de compra
function mostrarResumenCompra() {
  const carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
  if(carrito.length === 0) return;
  let total = 0;
  let resumen = `<div id="cartSummary" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.45);z-index:999;display:flex;align-items:center;justify-content:center;">
    <div style="background:#fff;padding:32px 28px;border-radius:18px;max-width:420px;width:90vw;box-shadow:0 4px 24px #0002;">
      <h3 style="margin-bottom:18px;text-align:center;">Resumen de compra</h3>
      <ul style="padding:0 0 12px 0;list-style:none;max-height:260px;overflow-y:auto;">
  `;
  carrito.forEach(p => {
    total += p.price * p.cantidad;
    resumen += `<li style="margin-bottom:10px;border-bottom:1px solid #eee;padding-bottom:8px;">
      <span style="font-weight:600;">${p.title}</span> <span style="color:#888;">x${p.cantidad}</span> <span style="float:right;font-weight:700;color:#d1bfa7;">$${(p.price*p.cantidad).toFixed(2)}</span>
    </li>`;
  });
  resumen += `</ul>
      <div style="text-align:right;font-size:1.1rem;font-weight:700;margin-bottom:18px;">Total: $${total.toFixed(2)}</div>
      <button onclick="document.getElementById('cartSummary').remove()" style="background:#d1bfa7;color:#fff;padding:8px 18px;border-radius:8px;border:none;cursor:pointer;font-weight:600;width:100%;">Cerrar</button>
    </div>
  </div>`;
  document.body.insertAdjacentHTML('beforeend', resumen);
}

function modificarCantidad(idx, delta) {
  let carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
  carrito[idx].cantidad += delta;
  if(carrito[idx].cantidad < 1) carrito[idx].cantidad = 1;
  localStorage.setItem('carrito', JSON.stringify(carrito));
  renderizarCarrito();
}

function eliminarDelCarrito(idx) {
  let carrito = JSON.parse(localStorage.getItem('carrito') || '[]');
  carrito.splice(idx, 1);
  localStorage.setItem('carrito', JSON.stringify(carrito));
  renderizarCarrito();
}

document.addEventListener('DOMContentLoaded', renderizarCarrito);
    </script>
  </body>
178764ac937563fe0cf915010092dde7895a8f81
</html>
